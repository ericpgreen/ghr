---
title: 
output: 
  revealjs::revealjs_presentation:
    theme: white
    highlight: tango
    center: true
    transition: none
    reveal_options:
      progress: true
      slideNumber: true
---

## {data-background="w03-cover.jpg"}

<style type="text/css">
p { text-align: left; }
</style>

## Objectives 

By the end of this session, you should be able to:

* Load data into R from multiple sources
* Write tidy code to inspect and clean your data
* Enjoy the tfw your code is commented and readable

## Login to Duke's Docker-ized version of RStudio Server

* Login to your instance by going to [https://vm-manage.oit.duke.edu/containers](https://vm-manage.oit.duke.edu/containers) and entering your NetID. 
* Click on Docker
* Click on RStudio
* When RStudio loads, restart the R session (`Ctrl/Cmd+Shift+F10`), clear the console (`Ctrl/Cmd+L`), and clear your workspace 

## Open your project

Last week you created a project for this workshop. Is this project still open? If not, click on the project icon to load it. (Don't create a new one.)

<center>
<img src="../img/project.png" style="background:none; border:none; box-shadow:none;">
</center>

## Confirm your working directory

In your console run:

```{r, eval=FALSE}
getwd()
```

If you successfully created a project and have this project open, the working directory should be your project directory

## Download the template

Change `products` to your preferred subfolder.

```{r, eval=FALSE}
  download.file("https://tinyurl.com/y7j7bkpm", 
                destfile = "products/lab-w03.Rmd")
```

## Open template file

<center>
<img src="../img/lab-w02.png" style="background:none; border:none; box-shadow:none;">
</center>

## CSV

A csv file is an ideal format for sharing data. Simple. Lightweight. Readable by any program. Import with the `read.csv()` function. Start by running `?read.csv` in the console to view the help file.

<center>
<img src="../img/readcsv.png" style="background:none; border:none; box-shadow:none;">
</center>

## ? Help File

`?read.csv`: What arguments are required?

<center>
<img src="../img/readcsv_ann.png" style="background:none; border:none; box-shadow:none;">
</center>

## CSV

Now import the csv file:

```{r, eval=FALSE}
datCSV <- read.csv("input/r2d2-w02.csv", stringsAsFactors = FALSE)
```

This will create an object called `datCSV`.

## {data-background-iframe="http://adv-r.had.co.nz/Style.html"}

## What's in a name

You can name this object anything you want. The most important thing is to be consistent. Here's Hadley's advice:

* Create meaningul names, not `foo` or `Eric2`
* Variable and function names should be lowercase
* Use an underscore (_) to separate words within a name 
* Variable names should be nouns and function names should be verbs
* camelCase is an option and can be used with _, as in `datWave1_wide`

## Examine the object

```{r, eval=FALSE}
str(datCSV)
```

<center>
<img src="../img/str_datCSV.png" style="background:none; border:none; box-shadow:none;">
</center>

## Data frame

R has several data types. `datCSV` is a **data frame** that consists of 372 rows and 13 variables. Let's use two built-in functions to do this count and print the results in line. Go to where you see the following line:

> The `datCSV` data frame has ... observations (rows) and ... columns.

Replace the first `...` with \``nrow(datCSV)`\` for the number of rows, and replace the second `...` with \``length(datCSV)`\` for the number of columns. Then knit your document.

## Glimpse

We can also examine `datCSV` with the `glimpse()` function in the `dplyr` package, which is included in the `tidyverse`. 

```{r, eval=FALSE}
library(tidyverse)
glimpse(datCSV)
```

If you get an error that there is no function called `glimpse`, run `install.packages("tidyverse")` in the console.

## Hide output

Knit the file and you'll see that the glimpse results print. Replace `{r glimpse}` with `{r glimpse, results='hide'}` and knit again.

## Stop code from printing

To turn off code printing, replace `{r glimpse, results='hide'}` with `{r glimpse, results='hide', echo=FALSE}` and knit again.

## Head/Tail

You can also use the functions `head()` or `tail()` to examine the first or last few rows.

```{r eval=FALSE}
head(datCSV)
tail(csv)
```

## Pretty tables

Use the `kableExtra` package to print nice HTML tables. Use this code and knit to HTML this time.

```{r eval=FALSE}
library(knitr)
library(kableExtra)
head(datCSV[, 1:6]) %>%
  kable("html") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"),
                full_width = F)
```

If you get an error that there is no function called `kable_styling`, run `install.packages("kableExtra")` in the console.

## Two new notations

Pipes `%>%` and [rows, columns]



















## Libraries

library(foreign)

library(tidyverse)

## Read it

* csv
* Excel
* Google Sheets
* Stata
* APIs

## Google Drive
* This will take you to your web authorization and give you access
 to your Google Drive files
 
library("googledrive")
drive_find(n_max = 25)

## API

* It's basically a web address
* then you tell R where to go and what language you want back (JSON, xml)
* then use an R package to get it into a format R can understand

## Check it out

* glimpse
* str
* plot it
* data science dinosaur (outliers)

## tidyr
glimpse()
group_by()
mutate()
summarise()
n()

## code
 <style>background-color:#FFFFFF</style>

  <pre><code>
defmodule Math do
  <mark>def sum(a, b) do</mark>
    <mark>a + b</mark>
  <mark>end</mark>
end
  </code></pre>

## Summary Statistics

* pipe something for groups

## other useful code

paste0()
loops


